{% load imagefit %}
{% load thedatalab_extras %}

{% if thing.is_topic or thing.is_author %}
  {% if thing.is_author %}
    <h2>Things {{ thing.title }} has authored:</h2>
  {% endif %}

  <div class="related">
    <ul class="nav nav-tabs" id="myTab" role="tablist">
      {% for heading in klasses.keys %}
      <li class="nav-item">
        <a class="nav-link {% if forloop.first %}active{% endif %}" id="{{ heading }}-tab" data-toggle="tab" data-target="#{{ heading }}" role="tab" aria-controls="{{ heading }}" aria-selected="true">{{ heading }}</a>
      </li>
      {% endfor %}
    </ul>

    <div class="tab-content" id="related-tab-content">
    {% for heading, related_things in klasses.items %}
      <div class="tab-pane fade show {% if forloop.first %}active{% endif %}" id="{{ heading }}" role="tabpanel" aria-labelledby="{{ heading }}-tab">
      {% for related_thing in related_things %}
        {% if related_thing != thing %}
          <div style="display: flex; margin-bottom: 1rem; border-bottom: solid gray 1px">
            <img src="{{ related_thing.image.name|resize:'200x140c'}}" width="200" height="140" style="margin-right: 10px; width: 200px">
            <div style="flex-direction: column">
              {% include thing.get_class.related_item_include_name  %}
            </div>
          </div>
        {% endif %}
      {% endfor %}
      </div>
    {% endfor %}
    </div>

{% else %}
  <div>
    <h1>Related resources</h1>
    This resource is about <a href="{{ topics.first.get_absolute_url }}">{{ topics.first.navigation_title }}</a>.  <a href="{% url index_url_name %}">View all {{ thing_plural }}</a>.
  </div>
{% endif %}
